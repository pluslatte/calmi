# テスト追加の検証内容メモ

各構造体（Accept, Activity, Collection, Create, Follow, Note, OrderedCollection, Person, Undo）に対して、以下の検証内容をテストとして追加することを提案します。これらは既存の `object.rs` のテストパターンを基にしています。主にデシリアライズ（JSON → 構造体）とシリアライズ（構造体 → JSON）の確認を重点に、エッジケースも含めます。

## 共通の検証内容（各構造体ごとに適用）

1. **最小限のデシリアライズテスト**:
   - `id` と `type` のみを含む JSON から正常にパースできるか確認。
   - 例: `{"id": "http://example.org/foo", "type": "Note"}` → Note 構造体。

2. **全フィールドを含むデシリアライズテスト**:
   - 構造体のすべてのフィールド（オプション含む）を設定した JSON からパースできるか確認。
   - 各フィールドの値が正しくマッピングされるか検証。
   - 例: Note の場合、`to`, `content`, `attributed_to`, `published` を含む JSON。

3. **Activity Streams 仕様に基づくデシリアライズテスト**:
   - W3C の Activity Streams Vocabulary から実際の例（または類似のもの）を使用。
   - 複雑なネスト（例: `attributedTo` が Person オブジェクト）を含む場合の確認。
   - 例: Person の場合、`inbox` や `outbox` を含む JSON。

4. **シリアライズテスト**:
   - 構造体インスタンスを JSON に変換できるか確認。
   - 出力された JSON が期待通りか検証（フィールドの順序や命名は serde の設定による）。

5. **オプションフィールドのシリアライズテスト**:
   - フィールドが `None` の場合、`skip_serializing_if` により JSON から省略されるか確認。
   - 例: `to` が `None` の Note をシリアライズすると、`to` フィールドが出力されない。

6. **型チェックテスト**:
   - パース後のフィールドの型が正しいか確認（例: `id` が URL 文字列、`type` が正しい文字列）。
   - ネストされたフィールド（例: `ObjectProperty` や `Actor`）の型も検証。

7. **エラーケースのデシリアライズテスト**:
   - 無効な JSON（例: 必須フィールド欠如、型ミスマッチ）でデシリアライズが失敗するか確認。
   - 例: `type` が間違った値の場合のエラー。

8. **コンテキスト（@context）を含むテスト**:
   - `@context` フィールドを含む JSON からパースできるか確認（Object ベースのため）。

これらのテストを各ファイルの末尾に `#[cfg(test)] mod tests { ... }` として追加します。テスト数は構造体の複雑さに応じて 3-5 個程度を目安に。実装前に、依存するプロパティ（例: `properties` モジュール）の型を確認してください。